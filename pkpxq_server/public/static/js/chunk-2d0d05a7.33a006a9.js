(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d05a7"],{"682a":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("el-form",{directives:[{name:"show",rawName:"v-show",value:t.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:t.queryParams,size:"small",inline:!0,"label-width":"68px"}},[a("el-form-item",{attrs:{label:"",prop:"status"}},[a("el-select",{attrs:{placeholder:"请选择",clearable:""},model:{value:t.queryParams.status,callback:function(e){t.$set(t.queryParams,"status",e)},expression:"queryParams.status"}},t._l(t.dict.type.sys_normal_disable,(function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:t.handleQuery}},[t._v("搜索")]),a("el-button",{attrs:{icon:"el-icon-refresh",size:"mini"},on:{click:t.resetQuery}},[t._v("重置")])],1)],1),a("el-row",{staticClass:"mb8",attrs:{gutter:10}},[a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:t.handleAdd}},[t._v("新增")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"success",plain:"",icon:"el-icon-edit",size:"mini",disabled:t.single},on:{click:t.handleUpdate}},[t._v("修改")])],1),a("el-col",{attrs:{span:1.5}},[a("el-button",{attrs:{type:"danger",plain:"",icon:"el-icon-delete",size:"mini",disabled:t.multiple},on:{click:t.handleDelete}},[t._v("删除")])],1),a("right-toolbar",{attrs:{showSearch:t.showSearch},on:{"update:showSearch":function(e){t.showSearch=e},"update:show-search":function(e){t.showSearch=e},queryTable:t.getList}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.tagList},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{label:"ID",align:"center",prop:"id"}}),a("el-table-column",{attrs:{label:"类名",align:"center",prop:"name"}}),a("el-table-column",{key:"status",attrs:{label:"状态",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-switch",{attrs:{"active-value":"0","inactive-value":"1"},on:{change:function(a){return t.handleStatusChange(e.row)}},model:{value:e.row.status,callback:function(a){t.$set(e.row,"status",a)},expression:"scope.row.status"}})]}}])}),a("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){return t.handleUpdate(e.row)}}},[t._v("修改")]),a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){return t.handleDelete(e.row)}}},[t._v("删除")])]}}])})],1),a("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.queryParams.page,limit:t.queryParams.pageSize},on:{"update:page":function(e){return t.$set(t.queryParams,"page",e)},"update:limit":function(e){return t.$set(t.queryParams,"pageSize",e)},pagination:t.getList}}),a("el-dialog",{attrs:{title:t.title,visible:t.open,width:"80%","append-to-body":""},on:{"update:visible":function(e){t.open=e}}},[a("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"60px"}},[a("el-form-item",{attrs:{label:"类名",prop:"name"}},[a("el-input",{attrs:{placeholder:"请输入类名"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"状态",prop:"status"}},[a("el-radio-group",{model:{value:t.form.status,callback:function(e){t.$set(t.form,"status",e)},expression:"form.status"}},t._l(t.dict.type.sys_normal_disable,(function(e){return a("el-radio",{key:e.value,attrs:{label:e.value}},[t._v(t._s(e.label))])})),1)],1),a("el-form-item",{attrs:{label:"标签",prop:"tagJson"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.form.tagJson&&t.form.tagJson.length>0?a("div",{staticClass:"scroll-y",staticStyle:{"max-height":"400px","overflow-y":"scroll"}},[a("div",{staticStyle:{display:"flex","flex-wrap":"wrap",gap:"5px"}},t._l(t.form.tagJson,(function(e,n){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":""},on:{close:function(a){return t.tagClose(e,n)}}},[t._v(" "+t._s(e)+" ")])})),1)]):t._e()]}}])}),a("el-divider"),a("div",{staticStyle:{"padding-left":"20px"}},[a("el-button",{attrs:{size:"small"},on:{click:function(e){t.form.tagJson=[]}}},[t._v(" 清除所有 ")]),t.showTagTextarea?t._e():a("el-button",{attrs:{size:"small"},on:{click:function(e){t.showTagTextarea=!0}}},[t._v(" 批量编辑 ")]),a("el-input",{directives:[{name:"show",rawName:"v-show",value:t.showTagInput,expression:"showTagInput"}],ref:"inputRef",staticStyle:{width:"60px","margin-left":"12px"},attrs:{size:"small"},on:{blur:t.handleTagInputConfirm,change:t.handleTagInputConfirm},model:{value:t.tagInputValue,callback:function(e){t.tagInputValue=e},expression:"tagInputValue"}}),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.showTagInput,expression:"!showTagInput"}],staticStyle:{"margin-left":"12px"},attrs:{size:"small"},on:{click:t.onShowTagInput}},[t._v(" + 新增 ")]),t.showTagTextarea?a("div",[a("br"),a("el-input",{attrs:{autosize:"",type:"textarea",placeholder:"批量修改，使用,分割"},model:{value:t.tagTextareaValue,callback:function(e){t.tagTextareaValue="string"===typeof e?e.trim():e},expression:"tagTextareaValue"}})],1):t._e()],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确 定")]),a("el-button",{on:{click:t.cancel}},[t._v("取 消")])],1)],1)],1)},s=[],l=(a("a15b"),a("d3b7"),a("6062"),a("3ca3"),a("ddb0"),a("d9e2"),a("d81d"),a("e9c4"),a("b64b"),a("a434"),a("14d9"),a("b775"));function i(t){return Object(l["a"])({url:"/tag/list",method:"get",params:t})}function o(t){return Object(l["a"])({url:"/tag/"+t,method:"get"})}function r(t){return Object(l["a"])({url:"/tag",method:"post",data:t})}function u(t){return Object(l["a"])({url:"/tag",method:"put",data:t})}function c(t){return Object(l["a"])({url:"/tag/"+t,method:"delete"})}a("5c96");var d={name:"Tag",dicts:["sys_normal_disable"],data:function(){return{showTagTextarea:!1,showTagInput:!1,tagInputValue:"",loading:!0,ids:[],single:!0,multiple:!0,showSearch:!0,total:0,tagList:[],title:"",open:!1,queryParams:{page:1,pageSize:10,sortOrder:"ASC",status:null},form:{},rules:{name:[{required:!0,message:"类名不能为空",trigger:"blur"}],status:[{required:!0,message:"请选择状态",trigger:"blur"}],tagJson:[{validator:this.validatePass,trigger:"blur"}]}}},computed:{tagTextareaValue:{get:function(){return this.form.tagJson.join(",")},set:function(t){var e=t.split(",");this.form.tagJson=e.length>0?e:[]}}},created:function(){this.getList()},methods:{validatePass:function(t,e,a){var n=new Set(e);0===e.length?a(new Error("标签不能为空")):n.size!==e.length?a(new Error("存在重复的标签内容")):a()},getList:function(){var t=this;this.loading=!0,i(this.queryParams).then((function(e){t.tagList=e.data.records,t.total=e.data.total,t.loading=!1}))},cancel:function(){this.open=!1,this.reset()},reset:function(){this.form={id:null,name:null,tagList:null,status:null,tagJson:[]},this.resetForm("form")},handleQuery:function(){this.queryParams.page=1,this.getList()},resetQuery:function(){this.resetForm("queryForm"),this.handleQuery()},handleSelectionChange:function(t){this.ids=t.map((function(t){return t.id})),this.single=1!==t.length,this.multiple=!t.length},handleAdd:function(){this.reset(),this.open=!0,this.title="添加标签"},handleUpdate:function(t){var e=this;this.reset();var a=t.id||this.ids;o(a).then((function(t){e.form=t.data,e.open=!0,e.title="修改标签"}))},submitForm:function(){var t=this;this.$refs["form"].validate((function(e,a){if(e)t.form.tagList=JSON.stringify(t.form.tagJson),null!=t.form.id?u(t.form).then((function(e){t.$modal.msgSuccess("修改成功"),t.open=!1,t.getList()})):r(t.form).then((function(e){t.$modal.msgSuccess("新增成功"),t.open=!1,t.getList()}));else{var n=Object.keys(a)[0];t.$modal.msgError(a[n][0].message)}}))},handleDelete:function(t){var e=this,a=t.id||this.ids;this.$modal.confirm('是否确认删除标签编号为"'+a+'"的数据项？').then((function(){return c(a)})).then((function(){e.getList(),e.$modal.msgSuccess("删除成功")})).catch((function(){}))},handleStatusChange:function(t){var e=this,a="0"===t.status?"启用":"禁用";u({id:t.id,status:t.status}).then((function(t){e.$modal.msgSuccess(a+"成功")})).catch((function(e){t.status="0"===t.status?"1":"0"}))},tagClose:function(t,e){this.form.tagJson.splice(e,1)},onShowTagInput:function(){this.showTagInput=!0,this.tagInputValue="",this.$refs["inputRef"].focus()},handleTagInputConfirm:function(){if(this.tagInputValue){var t=this.form.tagJson.indexOf(this.tagInputValue);-1===t?(this.form.tagJson.push(this.tagInputValue),this.tagInputValue="",this.showTagInput=!1):this.$modal.msgError("该标签已存在")}else this.showTagInput=!1}}},m=d,h=a("2877"),p=Object(h["a"])(m,n,s,!1,null,null,null);e["default"]=p.exports}}]);